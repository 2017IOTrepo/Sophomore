SLAVE		EQU	30H
		ORG	00H
		AJMP	MAIN
		ORG	23H
		LJMP	SSIO

		ORG	30H
MAIN:		MOV	SP,#60H
		MOV	TMOD,#20H
		MOV	TH1,#0FDH
		MOV	TL1,#0FDH	
		SETB	EA		;串行口开中断
		SETB	ES
		MOV	SCON,#0D8H
		MOV	PCON,#0
		SETB	TR1
		SETB	SM2
	
		MOV	A,#0FFH
		MOV	P1,A
		MOV	A,P1
		MOV	SLAVE,A
		MOV	R5,#00H
DISPLAY:	
		MOV	P2,R5
		AJMP	DISPLAY
SSIO:
		PUSH	Acc
		CLR	RI
		JB	RB8,ADDR
		MOV	A,SBUF
		MOV 	R5,A
RETURN:		POP	Acc
		SETB 	ES
		SETB	SM2
		RETI
ADDR:		
		
		MOV	A,SBUF		
		XRL	A,SLAVE
		JZ	CORRECT
		SETB	SM2
		POP	Acc
		RETI
CORRECT:
		
		CLR	SM2
		POP	ACC
		RETI 

		END
		
		

